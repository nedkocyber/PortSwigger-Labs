# Lab2: Exploiting NoSQL operator injection to bypass authentication


I start by intercepting the login request — this is the vulnerable endpoint. The request sends  and  as JSON fields to the backend

<img width="1040" height="599" alt="image" src="https://github.com/user-attachments/assets/d766cc75-7601-4cb4-8d30-2b8da1b820a5" />

What does it mean?
• 	 stands for "not equal"
• 	 is an empty string
So this payload tells the database:

Since most users have non-empty usernames and passwords, this query matches any valid account — even without knowing the actual credentials.

<img width="1039" height="594" alt="image" src="https://github.com/user-attachments/assets/aae14c02-2b09-455a-8645-8034777af7b0" />

The application uses MongoDB, which means we can inject NoSQL operators directly into the JSON payload.
We craft this payload:
```
{
  "username": { "$regex": ".*admin.*" },
  "password": { "$ne": "" }
}
```
What it does:
• matches any username containing “admin”
• ensures the password is not empty
This bypasses the login check by matching any admin-like user with a non-empty password — without knowing the actual credentials.

<img width="1035" height="534" alt="image" src="https://github.com/user-attachments/assets/6ec05728-b1c8-4978-ab47-485c726fbae9" />

We send the modified JSON payload. The server responds with a 302 redirect, which means login was successful.

<img width="1029" height="448" alt="image" src="https://github.com/user-attachments/assets/5038c822-fa5d-420c-bf71-de654d27c3c6" />

<img width="826" height="225" alt="image" src="https://github.com/user-attachments/assets/55a4e03b-9a18-4612-8457-65487b9683da" />

We copy the redirect link and open it in the browser. And we’re logged in as the administrator.

<img width="986" height="506" alt="image" src="https://github.com/user-attachments/assets/977fd2b3-90b3-4606-9bbb-2d86dc151174" />
